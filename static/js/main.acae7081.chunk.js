(this["webpackJsonpblog-alkemy"]=this["webpackJsonpblog-alkemy"]||[]).push([[0],{125:function(e,t,n){},252:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n(39),r=n.n(a),o=(n(124),n(125),n(13)),s=n(8),i=n(11),l=n(46),j=n(80),u=n(1),d=function(e){var t=e.activeKey,n=Object(s.f)();return Object(u.jsxs)(j.a,{bg:"light",sticky:"top",className:"justify-content-between",children:[Object(u.jsx)(j.a.Brand,{as:o.b,to:"/",children:"Blog"}),Object(u.jsxs)(l.a,{defaultActiveKey:t,className:"justify-content-end",children:[Object(u.jsx)(l.a.Link,{as:o.b,to:"/",eventKey:"/",children:"Home"}),Object(u.jsx)(l.a.Link,{as:o.b,to:"/create",eventKey:"/create",children:"Create"}),Object(u.jsx)(l.a.Link,{onClick:function(){localStorage.removeItem("token"),n.push("/login")},children:"Log out"})]})]})},h=n(65),b=n(59),O=n(20),m=n(34),f=n(35),x=function(e){var t=e.title,n=e.id,c=e.handleClickDelete,a=Object(s.f)();return Object(u.jsx)(h.a.Item,{action:!0,variant:"light",children:Object(u.jsxs)("div",{className:"justify-between",children:[Object(u.jsx)("p",{children:t}),Object(u.jsxs)(b.a,{size:"sm",className:"ButtonsPosts",children:[Object(u.jsx)(O.a,{variant:"secondary",onClick:function(){return function(e){a.push("/detail/".concat(e))}(n)},children:Object(u.jsx)(m.a,{icon:f.b})}),Object(u.jsx)(O.a,{variant:"secondary",onClick:function(){return function(e){a.push("/edit/".concat(e))}(n)},children:Object(u.jsx)(m.a,{icon:f.a})}),Object(u.jsx)(O.a,{variant:"secondary",onClick:function(){return c(n)},children:Object(u.jsx)(m.a,{icon:f.d})})]})]})})},p=function(e){var t=e.posts,n=e.page,c=e.handleClickDelete,a=10*(n-1),r=a+10,o=t.slice(a,r);return Object(u.jsx)(h.a,{children:o.map((function(e){return Object(u.jsx)(x,{title:e.title,id:e.id,handleClickDelete:c},e.id)}))})},g="https://jsonplaceholder.typicode.com/posts";var v=n(17),S=function(e){var t=e.totalPages,n=e.handlePage,c=e.pageNum,a=Object(v.a)(Array(t).keys()).map((function(e){return e+1}));return Object(u.jsx)("div",{className:"pagesGroup",children:Object(u.jsx)(b.a,{size:"sm",children:a.map((function(e){return Object(u.jsx)(O.a,{variant:"secondary",onClick:function(){return n(e)},active:e===c,children:e},e)}))})})};var y=n(113),w=function(){return Object(u.jsx)("div",{className:"divLogin loading",children:Object(u.jsx)(y.a,{animation:"border",role:"status",children:Object(u.jsx)("span",{className:"sr-only",children:"Loading..."})})})},N=function(){var e=Object(c.useState)(JSON.parse(localStorage.getItem("posts"))),t=Object(i.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(!1),o=Object(i.a)(r,2),l=o[0],j=o[1],h=Object(c.useState)(!0),b=Object(i.a)(h,2),O=b[0],m=b[1],f=Object(c.useState)(1),x=Object(i.a)(f,2),v=x[0],y=x[1],N=Object(c.useState)(0),k=Object(i.a)(N,2),C=k[0],I=k[1],E=localStorage.getItem("token"),T=Object(s.f)();Object(c.useEffect)((function(){E||T.push("/login")}),[]),Object(c.useEffect)((function(){var e=JSON.parse(localStorage.getItem("posts"));e&&(a(e),I(Math.ceil(e.length/10)))}),[l]),Object(c.useEffect)((function(){n?m(!1):fetch(g).then((function(e){return e.json()})).then((function(e){localStorage.setItem("posts",JSON.stringify(e))})).catch((function(e){return console.log(e)})).then((function(){return m(!1)})).catch((function(e){return console.log(e)}))}),[]);return O?Object(u.jsx)(w,{}):Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(d,{activeKey:"/"}),Object(u.jsx)("h1",{children:"Latest posts"}),Object(u.jsx)(p,{posts:n,page:v,handleClickDelete:function(e){(function(e){return fetch("".concat("https://jsonplaceholder.typicode.com/posts","/").concat(e),{method:"DELETE"}).then((function(){var t=JSON.parse(localStorage.getItem("posts")).filter((function(t){return t.id!==e}));return localStorage.setItem("posts",JSON.stringify(t)),"Deleted!"})).catch((function(e){console.log(e),alert("Something went wrong, please try again!")}))})(e).then((function(e){alert(e),j(!l)}))}}),Object(u.jsx)(S,{totalPages:C,handlePage:function(e){y(e)},pageNum:v})]})},k=n(22),C=function(){var e=Object(c.useState)(),t=Object(i.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(),o=Object(i.a)(r,2),l=o[0],j=o[1],h=Object(c.useState)(!0),b=Object(i.a)(h,2),x=b[0],p=b[1],v=localStorage.getItem("token"),S=Object(s.f)();Object(c.useEffect)((function(){v||S.push("/login")}),[]);var y=Object(s.g)().id;Object(c.useEffect)((function(){(function(e){return fetch("".concat(g,"/").concat(e)).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return console.log(e)}))})(y).then((function(e){a(e)})).catch((function(){return alert("Couldn't reach that post!")}))}),[y]),Object(c.useEffect)((function(){n&&function(e){return fetch("https://jsonplaceholder.typicode.com/users").then((function(e){return e.json()})).then((function(t){return t.find((function(t){return t.id===e}))})).catch((function(e){return console.log(e)}))}(n.userId).then((function(e){j(e),p(!1)}))}),[n]);return x?Object(u.jsx)(w,{}):Object(u.jsxs)("div",{children:[Object(u.jsx)(d,{}),n.title?Object(u.jsxs)(k.a,{className:"detailDiv",children:[Object(u.jsxs)(k.a.Header,{onClick:function(){S.goBack()},children:[Object(u.jsx)(m.a,{icon:f.c})," Back to posts"]}),Object(u.jsxs)(k.a.Body,{children:[Object(u.jsx)(k.a.Title,{children:n.title}),Object(u.jsx)(k.a.Subtitle,{className:"mb-2 text-muted",children:"Post ".concat(n.id)}),Object(u.jsx)(k.a.Text,{children:n.body}),Object(u.jsx)(O.a,{variant:"secondary",children:Object(u.jsx)("a",{href:"http://www.".concat(l.website),target:"_blank",rel:"noreferrer",children:"Read on website"})})]}),Object(u.jsx)(k.a.Footer,{className:"text-muted",children:Object(u.jsxs)("a",{href:"mailto:".concat(l.email),children:[Object(u.jsx)(m.a,{icon:f.e})," ".concat(l.username," - ").concat(l.name)]})})]}):Object(u.jsx)("h1",{children:"There is no post here!"})]})},I=n(10),E=n(63),T=n(31),B=n(81),J="https://jsonplaceholder.typicode.com/posts";var L=T.a().shape({title:T.b().min(4,"Must have at least 4 characters").max(40,"Can't be longer than 40 characters").required("Title is required"),content:T.b().min(10,"Must have at least 10 characters").max(1e3,"Can't be longer than 1000 characters").required("Content is required")}),P=function(e){var t=e.postToEdit,n=e.update,c=Object(s.f)();return Object(u.jsx)(E.a,{initialValues:{title:t?t.title:"",content:t?t.body:""},validationSchema:L,onSubmit:function(e,a){var r=a.setSubmitting,o=a.resetForm;r(!0),n?function(e,t){var n={id:t.id,title:e.title,body:e.content,userId:t.userId};return fetch("".concat(J,"/").concat(t.id),{method:"PUT",body:JSON.stringify(n),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(e){return e.json()})).then((function(e){console.log(e);var c=JSON.parse(localStorage.getItem("posts")).map((function(e){return e.id===t.id?n:e}));return localStorage.setItem("posts",JSON.stringify(c)),"Updated! Great job!"})).catch((function(e){console.log(e),alert("Something went wrong, please try again!")}))}(e,t).then((function(e){o(),alert(e),c.push("/")})).catch((function(e){console.log(e),alert("Something went wrong, please try again!")})):function(e){var t={title:e.title,body:e.content,userId:1};return fetch(J,{method:"POST",body:JSON.stringify(t),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(e){return e.json()})).then((function(e){console.log(e);var n=JSON.parse(localStorage.getItem("posts")),c=Object(B.a)(Object(B.a)({},t),{},{id:n[n.length-1].id+1}),a=n.concat(c);return localStorage.setItem("posts",JSON.stringify(a)),"Posted! Great job!"})).catch((function(e){console.log(e),alert("Something went wrong, please try again!")}))}(e).then((function(e){o(),alert(e)})).catch((function(e){console.log(e),alert("Something went wrong, please try again!")})),r(!1)},children:function(e){var t=e.values,n=e.errors,c=e.touched,a=e.handleChange,r=e.handleBlur,o=e.handleSubmit,s=e.isSubmitting;return Object(u.jsxs)(I.a,{className:"formPost",onSubmit:o,children:[Object(u.jsxs)(I.a.Group,{controlId:"exampleForm.ControlInput1",children:[Object(u.jsx)(I.a.Label,{children:"Title"}),Object(u.jsx)(I.a.Control,{type:"text",placeholder:"Title",name:"title",onChange:a,onBlur:r,value:t.title,className:c.title&&n.title?"error":null}),c.title&&n.title?Object(u.jsx)(I.a.Text,{className:"text-muted",children:n.title}):null]}),Object(u.jsxs)(I.a.Group,{controlId:"exampleForm.ControlTextarea1",children:[Object(u.jsx)(I.a.Label,{children:"Content"}),Object(u.jsx)(I.a.Control,{as:"textarea",rows:6,name:"content",onChange:a,onBlur:r,value:t.content,className:c.content&&n.content?"error":null}),c.content&&n.content?Object(u.jsx)(I.a.Text,{className:"text-muted",children:n.content}):null]}),Object(u.jsx)(O.a,{variant:"secondary",type:"submit",disabled:s,children:"Submit"})]})}})},q=function(){var e=localStorage.getItem("token"),t=Object(s.f)();return Object(c.useEffect)((function(){e||t.push("/login")}),[]),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(d,{activeKey:"/create"}),Object(u.jsx)("h1",{children:"Create a post"}),Object(u.jsx)(P,{})]})},F=function(){var e=Object(c.useState)(),t=Object(i.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(!0),o=Object(i.a)(r,2),l=o[0],j=o[1],h=localStorage.getItem("token"),b=Object(s.f)();Object(c.useEffect)((function(){h||b.push("/login")}),[]);var O=Object(s.g)().id;return Object(c.useEffect)((function(){var e=JSON.parse(localStorage.getItem("posts"));a(e.find((function(e){return e.id===parseInt(O)}))),j(!1)}),[]),l?Object(u.jsx)(w,{}):Object(u.jsxs)("div",{children:[Object(u.jsx)(d,{}),Object(u.jsx)("h1",{children:"Edit"}),Object(u.jsx)(P,{postToEdit:n,id:n.id,update:!0})]})},D=n(119),G=n.n(D),K=T.a().shape({email:T.b().email("Must be a valid email address").max(20,"Can't be longer than 20 characters").required("Email is required"),password:T.b().min(2,"Must have at least 2 characters").max(10,"Can't be longer than 10 characters").required("Password is required")}),M=function(){var e=Object(s.f)();return Object(u.jsx)("div",{className:"divLogin",children:Object(u.jsxs)(k.a,{children:[Object(u.jsx)(k.a.Header,{children:"Login"}),Object(u.jsx)(k.a.Body,{children:Object(u.jsx)(E.a,{initialValues:{email:"",password:""},validationSchema:K,onSubmit:function(t,n){var c,a=n.setSubmitting;a(!0),(c=t,G()({method:"post",url:"http://challenge-react.alkemy.org",data:c}).then((function(e){return e.data.token})).then((function(e){return localStorage.setItem("token",e),"ok"})).catch((function(e){return e}))).then((function(t){"ok"===t?e.push("/"):alert("Invalid email and password, please try again")})).catch((function(e){return console.log(e)})),a(!1)},children:function(e){var t=e.values,n=e.errors,c=e.touched,a=e.handleChange,r=e.handleBlur,o=e.handleSubmit,s=e.isSubmitting;return Object(u.jsxs)(I.a,{onSubmit:o,children:[Object(u.jsxs)(I.a.Group,{controlId:"formBasicEmail",children:[Object(u.jsx)(I.a.Label,{children:"Email address"}),Object(u.jsx)(I.a.Control,{type:"email",placeholder:"Enter email",name:"email",onChange:a,onBlur:r,value:t.email,className:c.email&&n.email?"error":null}),c.email&&n.email?Object(u.jsx)(I.a.Text,{className:"text-muted",children:n.email}):null]}),Object(u.jsxs)(I.a.Group,{controlId:"formBasicPassword",children:[Object(u.jsx)(I.a.Label,{children:"Password"}),Object(u.jsx)(I.a.Control,{type:"password",placeholder:"Enter password",name:"password",onChange:a,onBlur:r,value:t.password,className:c.password&&n.password?"error":null}),c.password&&n.password?Object(u.jsx)(I.a.Text,{className:"text-muted",children:n.password}):null]}),Object(u.jsx)(O.a,{variant:"secondary",type:"submit",disabled:s,children:"Submit"})]})}})})]})})};var U=function(){return Object(u.jsxs)(o.a,{basename:"/blog-alkemy-challenge",children:[Object(u.jsx)(s.b,{path:"/",exact:!0,children:Object(u.jsx)(N,{})}),Object(u.jsx)(s.b,{path:"/detail",exact:!0,children:Object(u.jsx)(s.a,{to:"/"})}),Object(u.jsx)(s.b,{path:"/detail/:id",children:Object(u.jsx)(C,{})}),Object(u.jsx)(s.b,{path:"/edit",exact:!0,children:Object(u.jsx)(s.a,{to:"/"})}),Object(u.jsx)(s.b,{path:"/edit/:id",exact:!0,children:Object(u.jsx)(F,{})}),Object(u.jsx)(s.b,{path:"/create",exact:!0,children:Object(u.jsx)(q,{})}),Object(u.jsx)(s.b,{path:"/login",exact:!0,children:Object(u.jsx)(M,{})})]})};r.a.render(Object(u.jsx)(U,{}),document.getElementById("root"))}},[[252,1,2]]]);
//# sourceMappingURL=main.acae7081.chunk.js.map